<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8"/>
<title>IMVU TV Player</title>

<style>
body{
  margin:0;
  background:#0b0b0c;
  font-family:Segoe UI, Arial;
  color:white;
  height:100vh;
  display:flex;
}

/* layout */
.wrapper{
  display:flex;
  width:100%;
  height:100%;
}

/* video area */
#player{
  flex:1;
  background:black;
}

/* right playlist drawer */
.playlist{
  width:240px;
  background:#111216;
  display:flex;
  flex-direction:column;
  border-left:1px solid #1f1f22;
}

.playlist h3{
  margin:12px;
  font-size:14px;
  opacity:.7;
}

#songs{
  flex:1;
  overflow-y:auto;
}

.song{
  padding:10px 12px;
  font-size:13px;
  cursor:pointer;
  border-radius:8px;
  margin:4px 8px;
}

.song:hover{
  background:#1e1f24;
}

/* bottom controls */
.controls{
  position:absolute;
  bottom:0;
  left:0;
  right:240px;

  display:flex;
  gap:8px;
  padding:10px;

  background:rgba(20,20,25,.9);
  backdrop-filter:blur(8px);
}

input{
  flex:1;
  background:#1b1c20;
  border:none;
  color:white;
  padding:10px;
  border-radius:10px;
}

button{
  background:#ff2d55;
  border:none;
  color:white;
  padding:10px 16px;
  border-radius:10px;
  cursor:pointer;
  font-weight:600;
}

button:hover{
  opacity:.85;
}

.volume{
  width:90px;
}
</style>
</head>

<body>

<div class="wrapper">

  <div id="player"></div>

  <div class="playlist">
    <h3>PLAYLIST</h3>
    <div id="songs"></div>
  </div>

</div>

<div class="controls">
  <input id="url" placeholder="Paste YouTube link or ID">
  <button onclick="addSong()">Add</button>
  <button onclick="player.playVideo()">Play</button>
  <button onclick="player.pauseVideo()">Pause</button>
  <input class="volume" type="range" min="0" max="100" value="80"
         oninput="player.setVolume(this.value)">
</div>

<script src="https://www.youtube.com/iframe_api"></script>

<script>
let player;
let playlist=[];
let current=0;

function onYouTubeIframeAPIReady(){
  player=new YT.Player('player',{
    width:'100%',
    height:'100%',
    playerVars:{controls:0},
    events:{onStateChange:onEnd}
  });
}

function getID(url){
  if(url.includes("v=")) return url.split("v=")[1].split("&")[0];
  if(url.includes("youtu.be/")) return url.split("youtu.be/")[1];
  return url;
}

async function addSong(){
  let input=document.getElementById("url");
  let id=getID(input.value.trim());
  if(!id) return;

  let title=await fetchTitle(id);

  playlist.push({id,title});
  render();
  input.value="";
}

function render(){
  let list=document.getElementById("songs");
  list.innerHTML="";

  playlist.forEach((s,i)=>{
    let div=document.createElement("div");
    div.className="song";
    div.textContent=(i+1)+". "+s.title;
    div.onclick=()=>play(i);
    list.appendChild(div);
  });
}

function play(i){
  current=i;
  player.loadVideoById(playlist[i].id);
}

function onEnd(e){
  if(e.data==0 && playlist.length){
    current=(current+1)%playlist.length;
    play(current);
  }
}

async function fetchTitle(id){
  let r=await fetch("https://noembed.com/embed?url=https://youtube.com/watch?v="+id);
  let j=await r.json();
  return j.title||"Video";
}
</script>

</body>
</html>
