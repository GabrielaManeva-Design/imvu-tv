<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8"/>
<title>IMVU TV Player</title>

<style>
body{
  margin:0;
  background:black;
  font-family:Segoe UI, Arial;
  overflow:hidden;
}

/* ===== VIDEO ===== */
#player{
  position:absolute;
  inset:0;
}

/* ===== CONTROLS ===== */
.controls{
  position:absolute;
  bottom:0;
  left:0;
  right:0;
  display:flex;
  gap:8px;
  padding:10px;
  background:rgba(15,15,18,.85);
  backdrop-filter:blur(10px);
}

input{
  flex:1;
  background:#1b1c20;
  border:none;
  color:white;
  padding:10px;
  border-radius:10px;
}

button{
  background:#ff2d55;
  border:none;
  width:42px;
  height:42px;
  border-radius:12px;
  cursor:pointer;
  display:flex;
  align-items:center;
  justify-content:center;
}

button svg{
  width:18px;
  height:18px;
  fill:white;
}

button:hover{ opacity:.85; }

.volume{ width:90px; }

/* ===== PLAYLIST DRAWER ===== */
.drawer{
  position:absolute;
  top:0;
  right:0;
  height:100%;
  width:240px;
  background:rgba(20,20,25,.65);
  backdrop-filter:blur(12px);
  transition:transform .25s ease;
  display:flex;
  flex-direction:column;
}

.drawer.hidden{
  transform:translateX(100%);
}

.drawerHeader{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:10px;
  font-size:13px;
  opacity:.7;
}

#songs{
  flex:1;
  overflow-y:auto;
}

.song{
  padding:8px 10px;
  margin:4px 8px;
  border-radius:8px;
  cursor:pointer;
  font-size:13px;
}

.song:hover{
  background:rgba(255,255,255,.1);
}

.openBtn{
  position:absolute;
  top:50%;
  right:0;
  transform:translateY(-50%);
  width:28px;
  height:60px;
  background:rgba(20,20,25,.7);
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
}
.openBtn svg{
  width:16px;
  height:16px;
  fill:white;
}
</style>
</head>

<body>

<div id="player"></div>

<!-- PLAYLIST -->
<div id="drawer" class="drawer">
  <div class="drawerHeader">
    <span>Playlist</span>

    <!-- CLOSE ICON -->
    <button onclick="toggleDrawer()">
      <svg viewBox="0 0 24 24">
        <path d="M15 6l-6 6 6 6"/>
      </svg>
    </button>
  </div>
  <div id="songs"></div>
</div>

<!-- OPEN ICON -->
<div id="openBtn" class="openBtn" onclick="toggleDrawer()" style="display:none;">
  <svg viewBox="0 0 24 24">
    <path d="M9 6l6 6-6 6"/>
  </svg>
</div>

<!-- CONTROLS -->
<div class="controls">

  <input id="url" placeholder="Paste YouTube link or ID">

  <!-- ADD (+) -->
  <button onclick="addSong()">
    <svg viewBox="0 0 24 24">
      <path d="M11 5h2v14h-2zM5 11h14v2H5z"/>
    </svg>
  </button>

  <!-- PLAY -->
  <button onclick="player.playVideo()">
    <svg viewBox="0 0 24 24">
      <path d="M8 5v14l11-7z"/>
    </svg>
  </button>

  <!-- PAUSE -->
  <button onclick="player.pauseVideo()">
    <svg viewBox="0 0 24 24">
      <path d="M6 5h4v14H6zm8 0h4v14h-4z"/>
    </svg>
  </button>

  <input class="volume" type="range" min="0" max="100" value="80"
         oninput="player.setVolume(this.value)">
</div>


<script src="https://www.youtube.com/iframe_api"></script>

<script>
let player;
let playlist=[];
let current=0;

function onYouTubeIframeAPIReady(){
  player=new YT.Player('player',{
    width:'100%',
    height:'100%',
    playerVars:{controls:0},
    events:{onStateChange:onEnd}
  });
}

function getID(url){
  if(url.includes("v=")) return url.split("v=")[1].split("&")[0];
  if(url.includes("youtu.be/")) return url.split("youtu.be/")[1];
  return url;
}

async function addSong(){
  let input=document.getElementById("url");
  let id=getID(input.value.trim());
  if(!id) return;

  let title=await fetchTitle(id);

  playlist.push({id,title});
  render();
  input.value="";
}

function render(){
  let list=document.getElementById("songs");
  list.innerHTML="";
  playlist.forEach((s,i)=>{
    let div=document.createElement("div");
    div.className="song";
    div.textContent=(i+1)+". "+s.title;
    div.onclick=()=>play(i);
    list.appendChild(div);
  });
}

function play(i){
  current=i;
  player.loadVideoById(playlist[i].id);
}

function onEnd(e){
  if(e.data==0 && playlist.length){
    current=(current+1)%playlist.length;
    play(current);
  }
}

async function fetchTitle(id){
  let r=await fetch("https://noembed.com/embed?url=https://youtube.com/watch?v="+id);
  let j=await r.json();
  return j.title||"Video";
}

function toggleDrawer(){
  let drawer=document.getElementById("drawer");
  let openBtn=document.getElementById("openBtn");

  drawer.classList.toggle("hidden");
  openBtn.style.display =
    drawer.classList.contains("hidden") ? "flex" : "none";
}
</script>

</body>
</html>
